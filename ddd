import pandas as pd

def extract_sector_series_from_column_b(file_path, sheet_name, sector_name):
    df = pd.read_excel(file_path, sheet_name=sheet_name, header=None)

    result = {
        'CL Factor': [],
        'sigma^2 CL': [],
        'estimation error CL Factor': []
    }

    headers = list(result.keys())
    current_header = None
    collecting = False

    for i, row in df.iterrows():
        cell = str(row[1]).strip() if pd.notna(row[1]) else ""

        # Start a new section
        if cell in headers:
            current_header = cell
            collecting = True
            continue

        # If we're collecting and hit another header line â€” stop collecting
        if collecting and cell in headers:
            collecting = False
            current_header = None
            continue

        if collecting and current_header:
            if cell == sector_name:
                # Collect values to the right
                values = []
                for val in row[2:]:
                    if pd.isna(val):
                        break
                    values.append(val)
                result[current_header] = values

    return result
