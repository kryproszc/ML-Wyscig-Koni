import numpy as np
from numba import njit

@njit
def wspolczynnik_LR(data_LR, w, exposure):
    n, m = data_LR.shape
    wsp_LR = np.empty(m)

    for j in range(m):
        numerator = 0.0
        denominator = 0.0

        for i in range(n):
            lr_ij = data_LR[i, j]
            w_ij = w[i, j]
            e_i = exposure[i]

            if not np.isnan(lr_ij) and not np.isnan(w_ij) and not np.isnan(e_i):
                numerator += lr_ij * w_ij * e_i
                denominator += w_ij * e_i

        if denominator == 0:
            wsp_LR[j] = 0.0  # lub np.nan je≈õli wolisz
        else:
            wsp_LR[j] = numerator / denominator

    return wsp_LR
