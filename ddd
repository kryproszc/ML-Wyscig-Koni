import pandas as pd

def extract_sector_series_from_column_b(file_path, sheet_name, sector_name):
    df = pd.read_excel(file_path, sheet_name=sheet_name, header=None)

    result = {
        'CL Factor': [],
        'sigma^2 CL': [],
        'estimation error CL Factor': []
    }

    headers = list(result.keys())
    current_header = None
    collecting = False

    for i, row in df.iterrows():
        cell = str(row[1]).strip() if pd.notna(row[1]) else ""

        # Jeśli trafimy na nagłówek (np. "CL Factor")
        if cell in headers:
            current_header = cell
            collecting = True
            continue

        if collecting and current_header:
            # Jeśli znowu trafimy na nagłówek — koniec poprzedniej sekcji
            if cell in headers:
                current_header = cell
                continue

            # Sprawdź, czy to nasz sektor
            if cell == sector_name:
                # Od kolumny C (index 2) w prawo, dopóki nie ma pustych
                values = []
                for val in row[2:]:
                    if pd.isna(val):
                        break
                    values.append(val)
                result[current_header] = values

    return result


file_path = 'twoj_plik.xlsx'
sheet_name = '2a. Chain-Ladder Paid'
sector_name = 'FIN'

values = extract_sector_series_from_column_b(file_path, sheet_name, sector_name)
print(values)
